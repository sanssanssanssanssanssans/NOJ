{% extends "base.html" %}
{% block content %}

<div class="card">
  <h2>Admin Panel</h2>
  <div class="row">
    <a class="btn" href="{{ url_for('problems.admin_problem_new') }}">New Problem</a>
  </div>
</div>

<div class="card">
  <h3>Problems</h3>
  <table>
    <thead>
      <tr><th>ID</th><th>Title</th><th>TL</th><th>ML</th><th>Visibility</th><th></th></tr>
    </thead>
    <tbody>
      {% for p in problems %}
      <tr>
        <td><code>{{ p.id }}</code></td>
        <td><a href="{{ url_for('problems.problem', pid=p.id) }}">{{ p.title }}</a></td>
        <td>{{ p.time_limit }}</td>
        <td>{{ p.memory_limit }}</td>
        <td>{{ p.visibility or 'public' }}</td>
        <td>
          <a class="btn secondary" href="{{ url_for('problems.admin_problem_edit', pid=p.id) }}">Edit</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="6" class="muted">No problems</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="card">
  <h3>Recent Submissions</h3>
  <table>
    <thead>
      <tr><th>ID</th><th>User</th><th>Problem</th><th>Lang</th><th>Result</th><th>At</th></tr>
    </thead>
    <tbody>
      {% for s in (submissions|sort(attribute='timestamp')|reverse|list)[:50] %}
      <tr>
        <td><a href="{{ url_for('submissions.api_submission', sid=s.id) }}" target="_blank">{{ s.id }}</a></td>
        <td>{{ s.username }}</td>
        <td><a href="{{ url_for('problems.problem', pid=s.problem_id) }}">{{ s.problem_id }}</a></td>
        <td>{{ s.language }}</td>
        <td>{{ s.result }}</td>
        <td>{{ s.timestamp }}</td>
      </tr>
      {% else %}
      <tr><td colspan="6" class="muted">No submissions</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>



{% endblock %}
